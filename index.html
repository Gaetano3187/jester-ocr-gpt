diff --git a/index.html b/index.html
index 32ab36c7520f9507e80a6f247eec57a8b56e6350..027ab718e9906c5b3558954ec580112bdb9d305c 100644
--- a/index.html
+++ b/index.html
@@ -1,98 +1,225 @@
 <!DOCTYPE html>
 <html lang="it">
 <head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
-  <title>Jester OCR GPT</title>
+  <title>Jester ‚Äì Assistente Spesa</title>
+  <link rel="manifest" href="/manifest.json">
   <style>
     body {
       font-family: Arial, sans-serif;
-      padding: 2rem;
-      background: #f9f9f9;
-      color: #333;
-    }
-    h1 {
-      color: #4CAF50;
-    }
-    button {
-      padding: 0.6rem 1.2rem;
-      background: #4CAF50;
-      color: white;
-      border: none;
-      border-radius: 8px;
-      cursor: pointer;
-      margin-top: 1rem;
-    }
-    #output {
-      margin-top: 1rem;
-      background: #fff;
       padding: 1rem;
-      border-radius: 8px;
-      white-space: pre-line;
+      background:#f9f9f9;
+      color:#333;
     }
+    h1 { color:#4CAF50; }
+    button { padding:0.6rem 1rem; background:#4CAF50; color:#fff; border:none; border-radius:6px; cursor:pointer; }
+    section { background:#fff; padding:1rem; border-radius:8px; margin-bottom:1rem; }
+    ul { list-style:none; padding:0; }
+    li { display:flex; align-items:center; margin-bottom:0.5rem; }
+    li span { flex-grow:1; }
+    li.completed span { text-decoration:line-through; color:#999; }
+    progress { width:100%; height:1rem; }
   </style>
 </head>
 <body>
-  <h1>üì∑ Jester ‚Äì OCR con GPT</h1>
-  <p>Carica uno scontrino per estrarre i prodotti.</p>
-
-  <input type="file" accept="image/*" capture="environment" id="cameraInput" onchange="handlePhotoUpload(event)" style="display:none;">
-  <button onclick="document.getElementById('cameraInput').click()">Scatta Foto (Scontrino)</button>
-
-  <div id="output">üìã Prodotti rilevati appariranno qui...</div>
+  <h1>üõí Jester ‚Äì Assistente Spesa</h1>
+  <button onclick="startVoice()">üé§ Comandi Vocali</button>
+  <section>
+    <h2>Supermercato</h2>
+    <input id="inputSuper" placeholder="Aggiungi prodotto"/>
+    <button onclick="addItem('super')">Aggiungi</button>
+    <ul id="listSuper"></ul>
+    <button onclick="exportList('super')">Esporta lista</button>
+    <progress id="progSuper" value="0" max="100"></progress>
+  </section>
+  <section>
+    <h2>Online</h2>
+    <input id="inputOnline" placeholder="Aggiungi prodotto"/>
+    <button onclick="addItem('online')">Aggiungi</button>
+    <ul id="listOnline"></ul>
+    <button onclick="exportList('online')">Esporta lista</button>
+    <progress id="progOnline" value="0" max="100"></progress>
+  </section>
+  <section>
+    <h2>Preferiti</h2>
+    <input id="inputFav" placeholder="Aggiungi preferito"/>
+    <button onclick="addFav()">Aggiungi</button>
+    <ul id="listFav"></ul>
+  </section>
+  <section>
+    <h2>OCR Scontrino</h2>
+    <input type="file" accept="image/*" capture="environment" id="cameraInput" onchange="handlePhoto(event)" style="display:none;">
+    <button onclick="document.getElementById('cameraInput').click()">Scatta Foto</button>
+    <pre id="ocrOutput">üìã Prodotti rilevati appariranno qui...</pre>
+  </section>
 
-  <script>
-    async function inviaFotoAVercel(base64Image) {
-      const res = await fetch('/api/ocr-gpt', {
-        method: 'POST',
-        headers: { 'Content-Type': 'application/json' },
-        body: JSON.stringify({ base64Image })
-      });
+<script>
+const storageKeys = {
+  super: 'jester_utente_supermercato',
+  online: 'jester_utente_online',
+  acqSuper: 'jester_utente_acquisti_supermercato',
+  acqOnline: 'jester_utente_acquisti_online',
+  fav: 'jester_utente_preferiti'
+};
 
-      if (!res.ok) {
-        const err = await res.text();
-        throw new Error('Errore OCR via Vercel: ' + err);
-      }
-
-      const result = await res.json();
-      return result.choices?.[0]?.message?.content || '';
-    }
+function loadList(key) {
+  return JSON.parse(localStorage.getItem(key) || '[]');
+}
+function saveList(key, arr) {
+  localStorage.setItem(key, JSON.stringify(arr));
+}
 
-    function handlePhotoUpload(event) {
-      const file = event.target.files[0];
-      if (!file) return;
+function render() {
+  ['super','online'].forEach(tipo => {
+    const listEl = document.getElementById(tipo === 'super' ? 'listSuper' : 'listOnline');
+    listEl.innerHTML = '';
+    const items = loadList(storageKeys[tipo]);
+    const done = loadList(tipo === 'super' ? storageKeys.acqSuper : storageKeys.acqOnline);
+    items.forEach((item,i)=>{
+      const li = document.createElement('li');
+      li.className = done.includes(item) ? 'completed' : '';
+      const span = document.createElement('span');
+      span.textContent = item;
+      const check = document.createElement('input');
+      check.type = 'checkbox';
+      check.checked = done.includes(item);
+      check.onchange = () => toggleDone(tipo,item);
+      const remove = document.createElement('button');
+      remove.textContent='‚ùå';
+      remove.onclick=()=>removeItem(tipo,item);
+      li.append(check,span,remove);
+      listEl.appendChild(li);
+    });
+    const prog = document.getElementById(tipo==='super'?'progSuper':'progOnline');
+    const val = items.length? (100*done.length/items.length):0;
+    prog.value = val;
+  });
 
-      const reader = new FileReader();
-      reader.onload = async function (e) {
-        const base64Image = e.target.result;
-        document.getElementById('output').innerText = 'üß† Analisi in corso...';
+  const favEl = document.getElementById('listFav');
+  favEl.innerHTML='';
+  loadList(storageKeys.fav).forEach(item=>{
+    const li=document.createElement('li');
+    const span=document.createElement('span');
+    span.textContent=item;
+    const addBtn=document.createElement('button');
+    addBtn.textContent='‚ûï';
+    addBtn.onclick=()=>{
+      document.getElementById('inputSuper').value=item;
+    };
+    li.append(span,addBtn);
+    favEl.appendChild(li);
+  });
+}
 
-        try {
-          const risposta = await inviaFotoAVercel(base64Image);
-          document.getElementById('output').innerText = `üìã Prodotti rilevati:\n${risposta}`;
-        } catch (err) {
-          document.getElementById('output').innerText = '‚ùå Errore: ' + err.message;
-        }
-      };
+function addItem(tipo){
+  const input=document.getElementById(tipo==='super'?'inputSuper':'inputOnline');
+  const val=input.value.trim();
+  if(!val) return;
+  const list=loadList(storageKeys[tipo]);
+  list.push(val);
+  saveList(storageKeys[tipo],list);
+  input.value='';
+  render();
+}
+function removeItem(tipo,item){
+  let list=loadList(storageKeys[tipo]);
+  list=list.filter(i=>i!==item);
+  saveList(storageKeys[tipo],list);
+  let done=loadList(tipo==='super'?storageKeys.acqSuper:storageKeys.acqOnline);
+  done=done.filter(i=>i!==item);
+  saveList(tipo==='super'?storageKeys.acqSuper:storageKeys.acqOnline,done);
+  render();
+}
+function toggleDone(tipo,item){
+  let done=loadList(tipo==='super'?storageKeys.acqSuper:storageKeys.acqOnline);
+  if(done.includes(item)){
+    done=done.filter(i=>i!==item);
+  }else{
+    done.push(item);
+  }
+  saveList(tipo==='super'?storageKeys.acqSuper:storageKeys.acqOnline,done);
+  render();
+}
+function exportList(tipo){
+  const items=loadList(storageKeys[tipo]);
+  const text=items.join('\n');
+  const blob=new Blob([text],{type:'text/plain'});
+  const url=URL.createObjectURL(blob);
+  const a=document.createElement('a');
+  a.href=url;
+  a.download=`${tipo}.txt`;
+  a.click();
+  URL.revokeObjectURL(url);
+}
+function addFav(){
+  const input=document.getElementById('inputFav');
+  const val=input.value.trim();
+  if(!val) return;
+  const fav=loadList(storageKeys.fav);
+  fav.push(val);
+  saveList(storageKeys.fav,fav);
+  input.value='';
+  render();
+}
 
-      reader.readAsDataURL(file);
+async function handlePhoto(e){
+  const file=e.target.files[0];
+  if(!file) return;
+  const reader=new FileReader();
+  reader.onload=async ev=>{
+    const base64=ev.target.result;
+    document.getElementById('ocrOutput').textContent='üß† Analisi in corso...';
+    try{
+      const res=await fetch('/api/ocr-gpt',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({base64Image:base64})});
+      if(!res.ok) throw new Error(await res.text());
+      const data=await res.json();
+      const content=data.choices?.[0]?.message?.content||'';
+      document.getElementById('ocrOutput').textContent=content;
+      localStorage.setItem('jester_ocr_confirmed',content);
+    }catch(err){
+      document.getElementById('ocrOutput').textContent='Errore: '+err.message;
     }
-  </script>
+  };
+  reader.readAsDataURL(file);
+}
 
-  <script>
-    if ('serviceWorker' in navigator) {
-      navigator.serviceWorker.register('/serviceWorker.js')
-        .then(reg => console.log("‚úÖ Service Worker registrato:", reg.scope))
-        .catch(err => console.error("‚ùå Registrazione SW fallita:", err));
+let recognition;
+function startVoice(){
+  if(!('webkitSpeechRecognition'in window||'SpeechRecognition'in window)){
+    alert('API Speech non supportata');
+    return;
+  }
+  recognition = new (window.SpeechRecognition||window.webkitSpeechRecognition)();
+  recognition.lang='it-IT';
+  recognition.onresult=async e=>{
+    let text=e.results[0][0].transcript.toLowerCase();
+    if(text.startsWith('ciao jester')) text=text.replace('ciao jester','').trim();
+    if(!text) return;
+    try{
+      const res=await fetch('/api/chat-gpt',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text})});
+      if(!res.ok) throw new Error(await res.text());
+      const data=await res.json();
+      const cmdStr=data.choices?.[0]?.message?.content||'';
+      const cmd=JSON.parse(cmdStr);
+      if(cmd.azione==='aggiungi'){
+        const input=cmd.lista==='online'?document.getElementById('inputOnline'):document.getElementById('inputSuper');
+        input.value=cmd.prodotto;
+        addItem(cmd.lista==='online'?'online':'super');
+      }
+      if(cmd.azione==='rimuovi') removeItem(cmd.lista==='online'?'online':'super',cmd.prodotto);
+      if(cmd.azione==='completa') toggleDone(cmd.lista==='online'?'online':'super',cmd.prodotto);
+    }catch(err){
+      console.error(err);
     }
-  </script>
+  };
+  recognition.start();
+}
 
-  <script>
-    if ('serviceWorker' in navigator) {
-      navigator.serviceWorker.register('/serviceWorker.js')
-        .then(reg => console.log('‚úÖ Service Worker registrato:', reg.scope))
-        .catch(err => console.error('‚ùå Errore SW:', err));
-    }
-  </script>
+render();
+if('serviceWorker'in navigator){
+  navigator.serviceWorker.register('/serviceWorker.js');
+}
+</script>
 </body>
 </html>
